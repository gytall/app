<!DOCTYPE html>
<html>
  <head>
    <title>Vacancies Table</title>
    <style>
      table {
        width: 100%;
        border-collapse: collapse;
      }
      table,
      th,
      td {
        border: 1px solid black;
      }
      th,
      td {
        padding: 10px;
        text-align: left;
      }
    </style>
    <script>
      async function searchVacancies() {
        const form = document.getElementById("searchForm");
        const formData = new FormData(form);

        const response = await fetch("/search", {
          method: "POST",
          body: formData,
        });
        const vacancies = await response.json();
        const tableBody = document.getElementById("tableBody");
        tableBody.innerHTML = "";

        if (vacancies.error) {
          tableBody.innerHTML = `<tr><td colspan="7">${vacancies.error}</td></tr>`;
          return;
        }

        vacancies.forEach((vacancy) => {
          const row = `<tr>
                    <td>${vacancy.name}</td>
                    <td>${vacancy.key_skills}</td>
                    <td>${vacancy.experience}</td>
                    <td>${vacancy.salary}</td>
                    <td>${vacancy.location}</td>
                    <td>${vacancy.company}</td>
                    <td><a href="${vacancy.url}">Link</a></td>
                </tr>`;
          tableBody.innerHTML += row;
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("searchForm").addEventListener("submit", (event) => {
          event.preventDefault();
          searchVacancies();
        });
      });
    </script>
  </head>
  <body>
    <h1>Vacancies</h1>
    <form id="searchForm">
      <label for="text">Text:</label>
      <input type="text" id="text" name="text" value="Python" />
      <label for="area">Area:</label>
      <input type="text" id="area" name="area" value="Москва" />
      <label for="per_page">Per Page:</label>
      <input type="number" id="per_page" name="per_page" value="20" />
      <label for="total">Total:</label>
      <input type="number" id="total" name="total" value="50" />
      <button type="submit">Search</button>
    </form>
    <table>
      <tr>
        <th>Name</th>
        <th>Key Skills / Requirements</th>
        <th>Experience</th>
        <th>Salary</th>
        <th>Location</th>
        <th>Company</th>
        <th>URL</th>
      </tr>
      <tbody id="tableBody"></tbody>
    </table>
  </body>
</html>
